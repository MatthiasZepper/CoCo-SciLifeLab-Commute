import {CodeSurfer} from "code-surfer";
import "prismjs/components/prism-r"
import {Notes} from 'mdx-deck'
import { CsvToHtmlTable } from 'react-csv-to-table';

import scilifelabTheme from "./styles/scilifelabTheme"
export const theme = scilifelabTheme

import { Logo, LogoNeu, Table, DataTable, Column } from './components'
import traffic from './assets/scilifelab/scilifelabtraffic.jpg'

import {datagetbb} from './data/getbb'

<Image
  src={traffic}
  style={{
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    color: 'white',
    backgroundColor: 'black',
  }}></Image>

## Commuter traffic analysis in R

<Notes>
None

</Notes>

---

### The osmdata query

<Table>
  <Column title="Where">
    <ul>
      <li>opq(getbb())&nbsp;%>% </li>
    </ul>
  </Column>
  <Column title="What">
    <ul>
      <li>add_features()&nbsp;%>% </li>
    </ul>
  </Column>
  <Column title="How">
    <ul>
      <li>osmdata_sc()</li>
    </ul>
  </Column>
</Table>

<Logo/>

<Notes>
None

</Notes>

---

<CodeSurfer>

```r title="Constructing an overpass query"
library("osmdata")
osmdata::opq ("stockholm se")
```

</CodeSurfer>

<Logo/>

<Notes>
None
</Notes>

---

<CodeSurfer>

```r title="Constructing an overpass query"
$bbox
[1] "59.1651172,17.9110935,59.4851172,18.2310935"

$prefix
[1] "[out:xml][timeout:25];\n(\n"

$suffix
[1] ");\n(._;>;);\nout body;"

$features
NULL

attr(,"class")
[1] "list"           "overpass_query"
attr(,"nodes_only")
[1] FALSE
```

</CodeSurfer>

<Logo/>

<Notes>
None

</Notes>

---

<CodeSurfer>

```r title="Obtaining the bounding box"
sthlm <- 
  osmdata::getbb(place_name = "Stockholm", 
                format_out = "data.frame")
print(sthlm[,c("display_name","importance")])
```

</CodeSurfer>

<Logo/>

<Notes>
The `opq` function works based on a bounding box of geospatial coordinates. Under the hood, it therefore calls the `getbb` function to derive a bounding box from a name or query based on an importance-ranked return.
</Notes>

---

<DataTable>
<CsvToHtmlTable
  data={datagetbb}
  csvDelimiter=","
  hasHeader="true"
/>
</DataTable>

<Logo/>

<Notes>
The `opq` function works based on a bounding box of geospatial coordinates. Under the hood, it therefore calls the `getbb` function to derive a bounding box from a name or query based on an importance-ranked return.
</Notes>

---
